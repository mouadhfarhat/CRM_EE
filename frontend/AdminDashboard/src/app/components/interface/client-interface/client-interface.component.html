<div class="hold-transition dark-mode sidebar-mini layout-fixed layout-navbar-fixed layout-footer-fixed">
    <div class="wrapper">
      <!-- Content Wrapper -->
      <div class="content-wrapper">
        <!-- Page Header -->
        <app-carousel></app-carousel>
        <div class="content-header">
          <div class="container-fluid">
            <div class="row mb-2">
              <div class="col-sm-6">
                <h1 class="m-0">Formations</h1>
              </div><!-- /.col -->
            </div><!-- /.row -->
          </div><!-- /.container-fluid -->
        </div>
  
        <!-- Main Content -->
        <section class="content">
          <div class="container-fluid">
            <div class="flex justify-content-center">
              <div class="card p-1 text-sm" style="max-width: 1000px; margin: auto;">
                <p-dataView #dv [value]="formations" [layout]="layout">
                  <!-- Header -->
                  <ng-template pTemplate="header">
                    <div class="relative flex justify-between items-center mb-2">
                      <div class="text-lg font-semibold">View Mode</div>
                      <div class="absolute top-0 right-0 flex gap-2">
                        <button class="view-toggle-btn" [class.active]="layout === 'list'" (click)="layout = 'list'">
                          <i class="pi pi-bars mr-1"></i> List
                        </button>
                        <button class="view-toggle-btn" [class.active]="layout === 'grid'" (click)="layout = 'grid'">
                          <i class="pi pi-th-large mr-1"></i> Grid
                        </button>
                      </div>
                    </div>
                  </ng-template>
  
                  <!-- List Layout -->
                  <ng-template pTemplate="list" let-formations>
                    <div class="grid grid-nogutter">
                      <div class="col-12" *ngFor="let item of formations; let first = first">
                        <div class="flex flex-column sm:flex-row sm:align-items-center p-2 gap-2">
                          <div class="md:w-6rem relative">
                            <img class="block xl:block mx-auto border-round w-full" [src]="item.image ? item.image : 'fallback.jpg'" [alt]="item.name" />
                            <p-tag [value]="item.inventoryStatus" [severity]="getSeverity(item)" class="absolute" [style.left.px]="2" [style.top.px]="2" />
                          </div>
  
                          <div class="flex flex-column md:flex-row justify-content-between md:align-items-center flex-1 gap-2">
                            <div class="flex flex-row md:flex-column justify-content-between align-items-start gap-1">
                              <div>
                                <span class="font-medium text-secondary text-xs">{{ item.category }}</span>
                                <div class="text-base font-medium text-900 mt-1">{{ item.name }}</div>
                              </div>
                              <div class="surface-100 p-1 border-round-2xl">
                                <div class="surface-0 flex align-items-center gap-1 justify-content-center py-1 px-2 border-round-2xl shadow-1">
                                  <span class="text-900 font-medium text-xs">{{ item.rating }}</span>
                                  <i class="pi pi-star-fill text-yellow-500 text-xs"></i>
                                </div>
                              </div>
                            </div>
  
                            <div class="flex flex-column md:align-items-end gap-2">
                              <span class="text-lg font-semibold text-900">{{ '$' + item.price }}</span>
                              <div class="flex gap-1">
                                <p-button size="small" icon="pi pi-shopping-cart" label="Buy Now" [disabled]="item.inventoryStatus === 'OUTOFSTOCK'" />
                                <p-button size="small" icon="pi pi-heart" [outlined]="true" />
                                <p-button size="small" icon="pi pi-info-circle" label="More Details" (click)="showDetails(item)" />
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </ng-template>
  
                  <!-- Grid Layout -->
                  <ng-template pTemplate="grid" let-formations>
                    <div class="grid grid-nogutter">
                      <div class="col-12 sm:col-6 lg:col-4 p-1" *ngFor="let item of formations">
                        <div class="p-2 border-1 surface-border surface-card border-round">
                          <div class="surface-50 flex justify-content-center border-round p-1">
                            <div class="relative">
                              <img class="border-round w-full" [src]="item.image ? item.image : 'fallback.jpg'" [alt]="item.name" style="max-width: 180px" />
                              <p-tag [value]="item.inventoryStatus" [severity]="getSeverity(item)" class="absolute" [style.left.px]="2" [style.top.px]="2" />
                            </div>
                          </div>
  
                          <div class="pt-2">
                            <div class="flex justify-content-between align-items-start">
                              <div>
                                <span class="font-medium text-secondary text-sm">{{ item.category }}</span>
                                <div class="text-lg font-medium text-900 mt-1">{{ item.name }}</div>
                              </div>
                              <div class="surface-100 p-1 border-round-2xl">
                                <div class="surface-0 flex align-items-center gap-2 justify-content-center py-1 px-2 border-round-2xl shadow-1">
                                  <span class="text-900 font-medium text-sm">{{ item.rating }}</span>
                                  <i class="pi pi-star-fill text-yellow-500"></i>
                                </div>
                              </div>
                            </div>
  
                            <div class="flex flex-column gap-3 mt-3">
                              <span class="text-xl font-semibold text-900">{{ '$' + item.price }}</span>
                              <div class="flex gap-2">
                                <p-button icon="pi pi-shopping-cart" label="Buy Now" [disabled]="item.inventoryStatus === 'OUTOFSTOCK'" />
                                <p-button icon="pi pi-heart" [outlined]="true" />
                                <p-button icon="pi pi-info-circle" size="small" label="More Details" (click)="showDetails(item)" />
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </ng-template>
  
                  <!-- Modal for Details -->
                  <p-dialog header="Formation Details" [(visible)]="detailsVisible" [style]="{width: '500px'}">
                    <div *ngIf="selectedFormation">
                        <p><strong>Category:</strong> {{ selectedFormation.category }}</p>
                        <p><strong>Name:</strong> {{ selectedFormation.name }}</p>
                        <p><strong>Price:</strong> {{ '$' + selectedFormation.price }}</p>
                        <p><strong>Rating:</strong> {{ selectedFormation.rating }}</p>
                        <p><strong>Description:</strong> {{ selectedFormation.description }}</p>
                        <div class="flex justify-content-end mt-3">
                            <p-button label="Make a Demand" icon="pi pi-paper-plane" (click)="makeDemande(selectedFormation)" />
                        </div>
                    </div>
                </p-dialog>
                
                </p-dataView>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>
  