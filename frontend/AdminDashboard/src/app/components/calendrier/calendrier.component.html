<div class="hold-transition dark-mode sidebar-mini layout-fixed layout-navbar-fixed layout-sidebar-fixed layout-footer-fixed">


<div class="wrapper">



      <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1>Calendar</h1>
          </div>
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item"><a href="#">Home</a></li>
              <li class="breadcrumb-item active">Calendar</li>
            </ol>
          </div>
        </div>
      </div><!-- /.container-fluid -->
    </section>

    <!-- Main content -->
    <section class="content">
      <div class="container-fluid">
        <div class="row">

          <div class="col-md-3">
            <div class="sticky-top mb-3">

              <div class="card event-form-card">
                <div class="card-header">
                  <h3 class="card-title">Create Event</h3>
                </div>
                <div class="card-body">
                  <!-- Color Picker -->
                  <div class="form-group">
                    <label>Event Color</label>
                    <div class="color-options">
                      <div
                        *ngFor="let color of colorOptions"
                        class="color-option"
                        [style.backgroundColor]="color.value"
                        [class.active]="selectedColor === color.value"
                        (click)="selectColor($event, color.value)"
                      >
                        <i *ngIf="selectedColor === color.value" class="fas fa-check"></i>
                      </div>
                    </div>
                  </div>
              
                  <!-- Title -->
                  <div class="form-group">
                    <label>Event Title</label>
                    <input
                      #newEventTitle
                      type="text"
                      class="form-control"
                      [(ngModel)]="newEvent.title"
                      placeholder="Enter event title"
                    />
                  </div>
              
                  <!-- Date Time -->
                  <div class="form-group">
                    <label>Start Time</label>
                    <input
                      type="datetime-local"
                      class="form-control"
                      [(ngModel)]="newEvent.startTime"
                    />
                  </div>
              
                  <div class="form-group">
                    <label>End Time</label>
                    <input
                      type="datetime-local"
                      class="form-control"
                      [(ngModel)]="newEvent.endTime"
                    />
                  </div>
              
                  <!-- Formation Selection -->
                  <div class="form-group">
                    <label>Formation</label>
                    <input
                      class="form-control mb-2"
                      type="text"
                      [(ngModel)]="formationSearchTerm"
                      (input)="onFormationSearch()"
                      placeholder="Search formations..."
                    />
                    <select
                      class="form-control"
                      [(ngModel)]="selectedFormationId"
                      (change)="onFormationSelect(selectedFormationId)"
                    >
                      <option [value]="undefined">Select a Formation</option>
                      <option
                        *ngFor="let formation of filteredFormations"
                        [value]="formation.id"
                      >
                        {{ formation.name }}
                      </option>
                    </select>
                  </div>
              
                  <!-- Group Selection -->
                  <div class="form-group" *ngIf="selectedFormationId">
                    <label>Groups</label>
                    <div class="group-list" [class.scrollable]="groups.length > 2">
                      <div
                        *ngFor="let group of groups"
                        class="group-item"
                        (click)="toggleGroupSelection(group.id)"
                        [class.selected]="isGroupSelected(group.id)"
                      >
                        <span>{{ group.name }}</span>
                        <i class="fas fa-check" *ngIf="isGroupSelected(group.id)"></i>
                      </div>
                    </div>
                    <div *ngIf="groups.length > 2" class="scroll-indicator">
                      Scroll to see more groups
                    </div>
                    <div *ngIf="groups.length === 0" class="no-groups">
                      No groups available for this formation.
                    </div>
                    <div class="group-actions" *ngIf="groups.length > 0">
                      <button
                        class="btn btn-sm btn-outline-primary"
                        (click)="selectAllGroups()"
                      >
                        Select All
                      </button>
                      <button
                        class="btn btn-sm btn-outline-secondary"
                        (click)="deselectAllGroups()"
                      >
                        Deselect All
                      </button>
                    </div>
                  </div>
              
                  <!-- Event Type -->
                  <div class="form-group">
                    <label>Event Type</label>
                    <select class="form-control" [(ngModel)]="newEvent.type">
                      <option *ngFor="let type of eventTypes" [value]="type">{{ type }}</option>
                    </select>
                  </div>
              
                  <!-- Add Button -->
                  <div class="form-group text-right " >
                    <button
                      (click)="createEvent(newEvent.title || '')"
                      type="button"
                      class="btn btn-primary "
                      [style.backgroundColor]="selectedColor"
                      [style.borderColor]="selectedColor"
                    >
                      Add Event
                    </button>
                  </div>
                </div>
              </div>









            </div> 
          </div>
          
          <!-- /.col -->
          <div class="col-md-9">
            <div class="card card-primary">
              <div class="card-body p-0">
                <!-- THE CALENDAR -->
                <div class="calendar-wrapper">
                  <div #calendar ></div>
                </div>
              </div>
              <!-- /.card-body -->
            </div>
            <!-- /.card -->
          </div>
          <!-- /.col -->
        </div>
        <!-- /.row -->
      </div><!-- /.container-fluid -->
    </section>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->



<!--pop up -->
<!-- Event Edit Modal -->

<!-- Edit Event Modal -->
<div *ngIf="isEditModalOpen" class="modal-backdrop-custom">
  <div class="modal-dialog-centered">
    <div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h5 class="modal-title">Edit Event</h5>
        <button
          type="button"
          class="close"
          (click)="isEditModalOpen = false"
        >
          Ã—
        </button>
      </div>

      <!-- Modal Body -->
      <div class="modal-body">
        <!-- Event Title (single row) -->
        <div class="form-group">
          <label>Title</label>
          <input
            type="text"
            class="form-control"
            [(ngModel)]="editableEvent.title"
          />
        </div>

        <!-- Start Time & End Time (same row) -->
        <div class="form-row">
          <div class="form-group col-md-6">
            <label>Start Time</label>
            <input
              type="datetime-local"
              class="form-control"
              [(ngModel)]="editableEvent.startTime"
            />
          </div>
          <div class="form-group col-md-6">
            <label>End Time</label>
            <input
              type="datetime-local"
              class="form-control"
              [(ngModel)]="editableEvent.endTime"
            />
          </div>
        </div>

        <!-- Formation & Groups (same row) -->
        <div class="form-row">
          <div class="form-group col-md-6">
            <label>Formation</label>
            <input
              type="text"
              class="form-control mb-2"
              [(ngModel)]="formationSearchTerm"
              (input)="onFormationSearch()"
              placeholder="Search formations..."
            />
            <select
              class="form-control"
              [(ngModel)]="editableEvent.formation.id"
              (change)="onEditFormationSelect(editableEvent.formation.id)"
            >
              <option [ngValue]="undefined">Select a Formation</option>
              <option
                *ngFor="let formation of filteredFormations"
                [ngValue]="formation.id"
              >
                {{ formation.name }}
              </option>
            </select>
          </div>
          <div class="form-group col-md-6" *ngIf="editableEvent.formation.id">
            <label>Groups</label>
            <div
              class="group-list"
              [class.scrollable]="editGroups.length > 2"
            >
              <div
                *ngFor="let group of editGroups"
                class="group-item"
                (click)="toggleEditGroupSelection(group.id)"
                [class.selected]="isEditGroupSelected(group.id)"
              >
                <span>{{ group.name }}</span>
                <i
                  class="fas fa-check"
                  *ngIf="isEditGroupSelected(group.id)"
                ></i>
              </div>
            </div>
            <div *ngIf="editGroups.length > 2" class="scroll-indicator">
              Scroll to see more groups
            </div>
            <div *ngIf="editGroups.length === 0" class="no-groups">
              No groups available for this formation.
            </div>
            <div class="group-actions" *ngIf="editGroups.length > 0">
              <button
                class="btn btn-sm btn-outline-primary"
                (click)="selectAllEditGroups()"
              >
                Select All
              </button>
              <button
                class="btn btn-sm btn-outline-secondary"
                (click)="deselectAllEditGroups()"
              >
                Deselect All
              </button>
            </div>
          </div>
        </div>

        <!-- Type & Color (same row) -->
        <div class="form-row">
          <div class="form-group col-md-6">
            <label>Type</label>
            <select
              class="form-control"
              [(ngModel)]="editableEvent.type"
            >
              <option *ngFor="let type of eventTypes" [value]="type">
                {{ type }}
              </option>
            </select>
          </div>
          <div class="form-group col-md-6">
            <label>Color</label>
            <input
              type="color"
              class="form-control"
              [(ngModel)]="editableEvent.backgroundColor"
            />
          </div>
        </div>
      </div>

      <!-- Modal Footer -->
      <div class="modal-footer">
        <button
          class="btn btn-secondary"
          (click)="isEditModalOpen = false"
        >
          Cancel
        </button>
        <button
          class="btn btn-danger"
          (click)="deleteEvent()"
        >
          Delete
        </button>
        <button
          class="btn btn-primary"
          (click)="updateEvent()"
        >
          Update
        </button>
      </div>
    </div>
  </div>
</div>




</div>

